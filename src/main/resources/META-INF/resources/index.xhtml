<f:view xmlns="http://www.w3c.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:ng="http://xmlns.jcp.org/jsf/passthrough"
        xmlns:p="http://primefaces.org/ui">
    <h:head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <title>#{menuController.title}</title>
        <style>
            body {font-size:12px; }
        </style>
        <script type="text/javascript">
            function start() {
                PF('mainAjaxLoader').show();
            }

            function stop() {
                PF('mainAjaxLoader').hide();
                updateUpload();
            }
        </script>
    </h:head>
    <h:body onload="updateUpload();" styleClass="ajaxTrigger" class="mBod">
        <h:form>
            <p:remoteCommand name="updateUpload"
                             onstart="PF('mainAjaxLoader').show();"
                             update="@(.updateUpload)"                       
                             actionListener="#{exporterController.checkRemoteService()}"
                             oncomplete="PF('mainAjaxLoader').hide();"
                             />
        </h:form>
        <center>
            <h:form style="width: 600px;" class="updateUpload" >
                <p:messages id="messages"  showDetail="true" autoUpdate="true" closable="false"/>
                <p:panel styleClass="stopPanel" header="Session Exporter Service">
                    <p:commandButton 
                        id="stop"
                        onstart="PF('mainAjaxLoader').show();"
                        oncomplete="PF('mainAjaxLoader').hide();"
                        actionListener="#{exporterController.stopApp()}"
                        ajax="true"
                        disabled="#{exporterController.isStopFlag()}"
                        value="STOP Service" />
                </p:panel>
                <p:panel header="Download Session" rendered="#{exporterController.isServiceAvailible()}">
                    <p:commandButton styleClass="ajaxTrigger"
                                     id="gen"
                                     value="Export"
                                     actionListener="#{exporterController.exportSessions()}"
                                     ajax="true"
                                     update="@(.downloadButton)"
                                     disabled="#{exporterController.getSessionExportStartDisable()}">

                    </p:commandButton>
                    <p:commandButton ajax="false"
                                     styleClass="downloadButton"
                                     value="Download"
                                     actionListener="#{exporterController.exportSessions()}"
                                     onclick="PrimeFaces.monitorDownload(start, stop);"
                                     disabled="#{exporterController.getSessionExportDownloadDisable()}">
                        <p:fileDownload value="#{exporterController.fileExport}" />
                    </p:commandButton>

                    <div></div>

                </p:panel>


            </h:form>
        </center>
        <p:outputPanel class="updater" >
            <p:blockUI id="mainAjaxLoader" class="mainAjaxLoader" block="@(.mBod)" trigger="@(.ajaxTrigger)" animate="true" widgetVar="mainAjaxLoader">
                <p:graphicImage value="ajax-loader.gif"/>
            </p:blockUI>
        </p:outputPanel>



    </h:body>
</f:view>
